<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InkWell - Coach Registration</title>
    <style>
        :root {
            --brand-primary: #2A6972;
            --brand-secondary: #388b97;
            --brand-light: #4A9BA8;
            --brand-lighter: #7BB8C4;
            --brand-primary-rgba: rgba(42, 105, 114, 0.3);
            --brand-primary-light-rgba: rgba(42, 105, 114, 0.1);
        }
        
        body {
            font-family: 'Alice', serif;
            background: #f8f9fa;
            margin: 0;
            padding: 2em;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .container {
            background: white;
            border-radius: 16px;
            padding: 2em;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        .logo {
            text-align: center;
            margin-bottom: 2em;
        }
        .logo img {
            max-height: 120px;
        }
        h1 {
            color: var(--brand-primary);
            text-align: center;
            margin-bottom: 1.5em;
            font-size: 1.8em;
        }
        .invitation-info {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 1.5em;
            margin-bottom: 2em;
            border-left: 4px solid var(--brand-primary);
        }
        .form-group {
            margin-bottom: 1.5em;
        }
        label {
            display: block;
            margin-bottom: 0.5em;
            font-weight: 600;
            color: #333;
        }
        input, select, textarea {
            width: 100%;
            padding: 0.75em;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            box-sizing: border-box;
            background: white;
        }
        input:focus, select:focus, textarea:focus {
            border-color: var(--brand-primary);
            outline: none;
            box-shadow: 0 0 0 2px var(--brand-primary-light-rgba);
        }
        textarea {
            height: 100px;
            resize: vertical;
        }
        .btn {
            background: var(--brand-primary);
            color: white;
            border: none;
            padding: 1em 2em;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: background 0.2s;
        }
        .btn:hover {
            background: #1e5055;
        }
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .status {
            margin-top: 1em;
            text-align: center;
            font-weight: 500;
        }
        .error {
            color: #dc3545;
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            padding: 0.75em;
            border-radius: 4px;
            margin-bottom: 1em;
        }
        .required {
            color: #dc3545;
        }
        .file-upload {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 1.5em;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #fafafa;
        }
        .file-upload:hover {
            border-color: var(--brand-primary);
            background: var(--brand-primary-light-rgba);
        }
        .file-upload.has-file {
            border-color: #28a745;
            background: #e8f5e8;
        }
        .file-upload input[type="file"] {
            display: none;
        }
        .file-upload-icon {
            font-size: 2em;
            color: #888;
            margin-bottom: 0.5em;
        }
        .file-upload.has-file .file-upload-icon {
            color: #28a745;
        }
        .file-name {
            color: #28a745;
            font-weight: 600;
            margin-top: 0.5em;
        }
        .help-text {
            color: #666;
            font-size: 0.85em;
            margin-top: 0.5em;
        }
        .terms-section {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 1.5em;
            margin-bottom: 1.5em;
            max-height: 300px;
            overflow-y: auto;
        }
        .terms-section h3 {
            color: var(--brand-primary);
            margin-top: 0;
            margin-bottom: 1em;
            font-size: 1.1em;
            border-bottom: 2px solid var(--brand-primary);
            padding-bottom: 0.5em;
        }
        .terms-section ol {
            padding-left: 1.5em;
            margin: 0;
        }
        .terms-section li {
            margin-bottom: 1em;
            line-height: 1.5;
            font-size: 0.9em;
        }
        .terms-section li strong {
            color: #333;
        }
        .agreement-checkbox {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 1em;
            margin-bottom: 1.5em;
        }
        .agreement-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-top: 2px;
            flex-shrink: 0;
            cursor: pointer;
        }
        .agreement-checkbox label {
            margin: 0;
            font-weight: 500;
            cursor: pointer;
            line-height: 1.5;
        }
        .signature-icon {
            font-size: 1.2em;
            margin-right: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">
            <img src="InkWell-Logo.png" alt="InkWell">
        </div>
        
        <h1>Coach Registration</h1>
        
        <div id="invitationInfo" class="invitation-info">
            <p><strong>Loading invitation details...</strong></p>
        </div>
        
        <div id="errorMessage" class="error" style="display: none;"></div>
        
        <form id="registrationForm" style="display: none;">
            <div class="form-group">
                <label for="email">Email Address <span class="required">*</span></label>
                <input type="email" id="email" required>
            </div>
            
            <div class="form-group">
                <label for="password">Create Password <span class="required">*</span></label>
                <input type="password" id="password" required minlength="6">
            </div>
            
            <div class="form-group">
                <label for="fullName">Full Name <span class="required">*</span></label>
                <input type="text" id="fullName" required>
            </div>
            
            <div class="form-group">
                <label for="credentials">Coaching Credentials <span class="required">*</span></label>
                <input type="text" id="credentials" placeholder="e.g., ICF ACC, NBC-HWC, CPC, CLC" required>
                <p class="help-text">Enter your coaching certification(s)</p>
            </div>
            
            <div class="form-group">
                <label for="issuingOrg">Issuing Organization <span class="required">*</span></label>
                <input type="text" id="issuingOrg" placeholder="e.g., ICF, NBHWC, iPEC, CTI" required>
                <p class="help-text">Organization that issued your certification</p>
            </div>
            
            <div class="form-group">
                <label for="practiceLocation">Practice Location</label>
                <input type="text" id="practiceLocation" placeholder="City, State/Country">
            </div>
            
            <div class="form-group">
                <label for="practiceDescription">Brief Practice Description</label>
                <textarea id="practiceDescription" placeholder="Briefly describe your coaching practice, specialties, or approach..."></textarea>
            </div>
            
            <div class="form-group">
                <label>Liability Insurance Certificate <span class="required">*</span></label>
                <div class="file-upload" id="fileUploadArea">
                    <input type="file" id="insuranceCert" accept=".pdf,.jpg,.jpeg,.png" required>
                    <div class="file-upload-icon">üìÑ</div>
                    <p>Click or drag to upload your current insurance certificate</p>
                    <p class="help-text">PDF, JPG, or PNG (max 10MB)</p>
                    <p class="file-name" id="fileName" style="display: none;"></p>
                </div>
                <p class="help-text">Professional liability insurance is required for all coaches on InkWell.</p>
            </div>
            
            <div class="form-group">
                <label for="insuranceExpiration">Insurance Expiration Date <span class="required">*</span></label>
                <input type="date" id="insuranceExpiration" required>
                <p class="help-text">Policy must be valid for at least 60 days from today.</p>
                <p id="expirationError" class="help-text" style="color: #dc3545; display: none;"></p>
            </div>
            
            <!-- Coach/Practitioner Terms -->
            <div class="form-group">
                <label>Coach/Practitioner Terms <span class="required">*</span></label>
                <div class="terms-section">
                    <h3>üìã COACH/PRACTITIONER TERMS</h3>
                    <p style="margin-bottom: 1em; font-size: 0.9em;">By registering as a Coach on InkWell, you acknowledge and agree to the following:</p>
                    <ol>
                        <li><strong>Independent Contractor Status:</strong> You are an independent contractor, not an employee, agent, or partner of Pegasus Realm. You are solely responsible for your own taxes, insurance, and compliance with applicable laws.</li>
                        <li><strong>Revenue Sharing:</strong> Coaches earn 60% of Connect subscription revenue from clients connected to them. Pegasus Realm retains 30%, with ~10% allocated to payment processing. Payouts occur monthly via Stripe Connect/PayPal for balances exceeding $25.</li>
                        <li><strong>No Professional Advice:</strong> Coaches provide reflective support and guidance, NOT mental health treatment, therapy, or medical advice. Coaches are solely responsible for the content and quality of their responses to clients.</li>
                        <li><strong>Liability:</strong> Pegasus Realm is not liable for any harm, injury, or damages arising from coach-client interactions. Coaches must maintain their own professional liability insurance.</li>
                        <li><strong>Termination:</strong> Pegasus Realm reserves the right to terminate coach accounts at any time for violations of these Terms, including inappropriate conduct, fraudulent credentials, or failure to respond to clients.</li>
                        <li><strong>Client Ownership:</strong> Client relationships formed through InkWell are considered platform relationships. Upon termination, coaches may not solicit InkWell clients to off-platform services for 12 months.</li>
                    </ol>
                </div>
            </div>
            
            <div class="agreement-checkbox">
                <input type="checkbox" id="termsAgreement" required>
                <label for="termsAgreement">
                    <span class="signature-icon">‚úçÔ∏è</span>
                    <strong>I agree to the Coach/Practitioner Terms above.</strong><br>
                    <span style="font-size: 0.9em; color: #666;">By checking this box, I am providing my digital signature and legally binding agreement to these terms.</span>
                </label>
            </div>
            
            <button type="submit" class="btn" id="submitBtn">
                Complete Registration
            </button>
            
            <div id="status" class="status"></div>
        </form>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { getAuth, createUserWithEmailAndPassword } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';
        import { getFirestore, doc, getDoc, setDoc, serverTimestamp, updateDoc } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';
        import { getStorage, ref, uploadBytes, getDownloadURL } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-storage.js';

        const firebaseConfig = {
            apiKey: "AIzaSyDivYKnp_SinGjL7iVVwSyQH-RnFHMFDM0",
            authDomain: "inkwelljournal.io",
            projectId: "inkwell-alpha",
            storageBucket: "inkwell-alpha.firebasestorage.app",
            messagingSenderId: "849610731668",
            appId: "1:849610731668:web:f06d1a63f0db6391674481",
            measurementId: "G-KHHZRVB7EJ"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);

        // Store invitation data globally
        let invitationData = null;

        // File upload handling
        const fileInput = document.getElementById('insuranceCert');
        const fileUploadArea = document.getElementById('fileUploadArea');
        const fileNameDisplay = document.getElementById('fileName');

        fileUploadArea.addEventListener('click', () => fileInput.click());
        
        fileUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUploadArea.style.borderColor = '#2A6972';
        });
        
        fileUploadArea.addEventListener('dragleave', () => {
            fileUploadArea.style.borderColor = '#ddd';
        });
        
        fileUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                fileInput.files = files;
                handleFileSelect(files[0]);
            }
        });
        
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFileSelect(e.target.files[0]);
            }
        });

        function handleFileSelect(file) {
            // Validate file size (10MB max)
            if (file.size > 10 * 1024 * 1024) {
                alert('File is too large. Maximum size is 10MB.');
                return;
            }
            
            // Validate file type
            const validTypes = ['application/pdf', 'image/jpeg', 'image/jpg', 'image/png'];
            if (!validTypes.includes(file.type)) {
                alert('Invalid file type. Please upload a PDF, JPG, or PNG file.');
                return;
            }
            
            fileUploadArea.classList.add('has-file');
            fileNameDisplay.textContent = '‚úÖ ' + file.name;
            fileNameDisplay.style.display = 'block';
        }

        // Get invitation token from URL
        const urlParams = new URLSearchParams(window.location.search);
        const token = urlParams.get('token');

        if (!token) {
            document.getElementById('errorMessage').style.display = 'block';
            document.getElementById('errorMessage').textContent = 'Invalid invitation link. Please contact support.';
        } else {
            loadInvitation();
        }

        async function loadInvitation() {
            try {
                console.log("Loading invitation for token:", token);
                
                const response = await fetch('https://us-central1-inkwell-alpha.cloudfunctions.net/validateInvitation', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ token: token })
                });
                
                const result = await response.json();
                console.log("Validation result:", result);
                
                if (!response.ok) {
                    throw new Error(result.error || 'Invitation not found or expired. Please contact support.');
                }
                
                invitationData = result.invitation;
                
                // Display invitation info - show the USER's name (who invited), not the coach's name
                document.getElementById('invitationInfo').innerHTML = `
                    <div style="background: #e8f5e8; border: 1px solid #4caf50; padding: 1em; border-radius: 8px;">
                        <p><strong>‚úÖ Valid Invitation Found!</strong></p>
                        <p><strong>Invitation from:</strong> ${invitationData.fromUserName || 'InkWell User'}</p>
                        <p>You've been invited to join InkWell as <strong>${invitationData.fromUserName || 'their'}</strong>'s coach.</p>
                    </div>
                `;
                
                // Pre-fill email and name from the coach's info
                document.getElementById('email').value = invitationData.practitionerEmail || '';
                document.getElementById('fullName').value = invitationData.practitionerName || '';
                
                // Show form
                document.getElementById('registrationForm').style.display = 'block';
                
            } catch (error) {
                console.error("Error loading invitation:", error);
                document.getElementById('errorMessage').style.display = 'block';
                document.getElementById('errorMessage').textContent = `‚ùå ${error.message}`;
                document.getElementById('errorMessage').innerHTML += `
                    <br><br><small style="color: #666;">
                        If this persists, please contact support.
                    </small>
                `;
            }
        }

        document.getElementById('registrationForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const status = document.getElementById('status');
            const expirationError = document.getElementById('expirationError');
            
            // Validate insurance file is selected
            const insuranceFile = document.getElementById('insuranceCert').files[0];
            if (!insuranceFile) {
                status.innerHTML = '<span style="color: #dc3545;">‚ùå Please upload your liability insurance certificate.</span>';
                return;
            }
            
            // Validate insurance expiration date (must be > 60 days from now)
            const expirationInput = document.getElementById('insuranceExpiration').value;
            if (!expirationInput) {
                status.innerHTML = '<span style="color: #dc3545;">‚ùå Please enter your insurance expiration date.</span>';
                return;
            }
            
            const expirationDate = new Date(expirationInput);
            const today = new Date();
            const sixtyDaysFromNow = new Date();
            sixtyDaysFromNow.setDate(today.getDate() + 60);
            
            if (expirationDate <= sixtyDaysFromNow) {
                const daysUntilExpiration = Math.ceil((expirationDate - today) / (1000 * 60 * 60 * 24));
                expirationError.textContent = `‚ùå Insurance expires in ${daysUntilExpiration} days. Policy must be valid for at least 60 days. Please provide a policy with a later expiration date.`;
                expirationError.style.display = 'block';
                status.innerHTML = '<span style="color: #dc3545;">‚ùå Insurance policy expires too soon. Please provide valid insurance.</span>';
                return;
            }
            expirationError.style.display = 'none';
            
            // Validate terms agreement
            const termsAgreement = document.getElementById('termsAgreement');
            if (!termsAgreement.checked) {
                status.innerHTML = '<span style="color: #dc3545;">‚ùå You must agree to the Coach/Practitioner Terms to continue.</span>';
                return;
            }
            
            submitBtn.disabled = true;
            submitBtn.textContent = 'Creating Account...';
            status.innerHTML = '<span style="color: #2A6972;">Processing registration...</span>';
            
            try {
                const formData = {
                    email: document.getElementById('email').value.trim(),
                    password: document.getElementById('password').value,
                    fullName: document.getElementById('fullName').value.trim(),
                    credentials: document.getElementById('credentials').value.trim(),
                    issuingOrg: document.getElementById('issuingOrg').value.trim(),
                    practiceLocation: document.getElementById('practiceLocation').value.trim(),
                    practiceDescription: document.getElementById('practiceDescription').value.trim(),
                    insuranceExpiration: expirationDate
                };
                
                // Create Firebase Auth account
                status.innerHTML = '<span style="color: #2A6972;">Creating account...</span>';
                const userCredential = await createUserWithEmailAndPassword(auth, formData.email, formData.password);
                const user = userCredential.user;
                
                // Upload insurance certificate to Firebase Storage
                status.innerHTML = '<span style="color: #2A6972;">Uploading insurance certificate...</span>';
                const timestamp = Date.now();
                const fileExtension = insuranceFile.name.split('.').pop();
                const storagePath = `coach-insurance/${user.uid}/${timestamp}_insurance.${fileExtension}`;
                const storageRef = ref(storage, storagePath);
                
                await uploadBytes(storageRef, insuranceFile);
                const insuranceUrl = await getDownloadURL(storageRef);
                
                // Create coach application document
                status.innerHTML = '<span style="color: #2A6972;">Submitting application...</span>';
                await setDoc(doc(db, 'practitionerApplications', user.uid), {
                    userId: user.uid,
                    invitationToken: token,
                    email: formData.email,
                    name: formData.fullName,
                    credentials: formData.credentials,
                    issuingOrganization: formData.issuingOrg,
                    practiceLocation: formData.practiceLocation,
                    practiceDescription: formData.practiceDescription,
                    insuranceCertificate: {
                        url: insuranceUrl,
                        fileName: insuranceFile.name,
                        uploadedAt: serverTimestamp(),
                        storagePath: storagePath,
                        expirationDate: formData.insuranceExpiration
                    },
                    coachTermsAgreed: true,
                    coachTermsAgreedAt: serverTimestamp(),
                    coachTermsVersion: '2026-01-21',
                    status: 'pending',
                    createdAt: serverTimestamp()
                });
                
                // Archive insurance document reference
                await setDoc(doc(db, 'coachInsuranceRecords', `${user.uid}_${timestamp}`), {
                    coachId: user.uid,
                    coachEmail: formData.email,
                    coachName: formData.fullName,
                    fileName: insuranceFile.name,
                    fileUrl: insuranceUrl,
                    storagePath: storagePath,
                    expirationDate: formData.insuranceExpiration,
                    uploadedAt: serverTimestamp(),
                    status: 'current'
                });
                
                // Create basic user document
                await setDoc(doc(db, 'users', user.uid), {
                    userId: user.uid,
                    email: formData.email,
                    displayName: formData.fullName,
                    signupUsername: formData.fullName,
                    accountType: 'standard',
                    userRole: 'coach_pending',
                    agreementAccepted: true,
                    insightsPreferences: {
                        weeklyEnabled: true,
                        monthlyEnabled: true,
                        createdAt: serverTimestamp()
                    },
                    createdAt: serverTimestamp()
                });
                
                // Update invitation status
                await updateDoc(doc(db, 'practitionerInvitations', token), {
                    status: 'registered',
                    practitionerId: user.uid,
                    registeredAt: serverTimestamp()
                });
                
                status.innerHTML = `
                    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #d4f5d4 100%); border: 1px solid #4caf50; border-left: 6px solid #2A6972; padding: 2em; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                        <div style="text-align: center; margin-bottom: 1.5em;">
                            <div style="font-size: 3em; color: #2A6972; margin-bottom: 0.5em;">üéâ</div>
                            <h2 style="color: #2A6972; margin: 0; font-size: 1.8em; font-weight: 600;">Thank You for Your Application!</h2>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.7); padding: 1.5em; border-radius: 8px; margin-bottom: 1.5em;">
                            <h3 style="color: #2A6972; margin-top: 0; font-size: 1.3em;">‚úÖ Application Submitted Successfully</h3>
                            <p style="margin: 0.5em 0; color: #333; line-height: 1.6;">
                                Thank you for applying, <strong>${formData.fullName}</strong>! Our team will review your credentials and insurance, and you will receive a confirmation email with next steps, typically within <strong>72 hours</strong>.
                            </p>
                            <p style="margin: 1em 0 0 0; color: #666; font-size: 0.95em;">
                                Questions? Reach out to <a href="mailto:support@inkwelljournal.io" style="color: #2A6972; text-decoration: none; font-weight: 600;">support@inkwelljournal.io</a>
                            </p>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, rgba(42,105,114,0.1), rgba(42,105,114,0.05)); padding: 1.5em; border-radius: 8px; border: 2px solid #2A6972; margin-bottom: 1.5em;">
                            <h3 style="color: #2A6972; margin-top: 0; font-size: 1.3em;">üéÅ Coach Benefit: 25% Discount!</h3>
                            <p style="margin: 0.5em 0; color: #333; line-height: 1.6;">
                                As a certified coach, you receive a <strong>25% discount</strong> on all InkWell paid subscriptions. Experience the power of journaling firsthand and better support your clients who use our platform.
                            </p>
                            <div style="margin-top: 1.2em;">
                                <a href="https://inkwelljournal.io/app.html" target="_blank" style="display: inline-block; background: #2A6972; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; font-weight: 600;">
                                    üåê Launch Web App
                                </a>
                            </div>
                        </div>

                        <div style="background: rgba(255,255,255,0.9); padding: 1.5em; border-radius: 8px; border: 1px solid #ddd; margin-bottom: 1.5em;">
                            <h3 style="color: #2A6972; margin-top: 0; font-size: 1.2em;">üì± Get the Mobile App</h3>
                            <p style="margin: 0.5em 0 1em 0; color: #666;">Download InkWell for iOS and Android (coming soon)</p>
                            <div style="display: flex; gap: 1em; flex-wrap: wrap; align-items: center;">
                                <a href="https://apps.apple.com/app/inkwell" target="_blank" style="display: inline-block;">
                                    <img src="https://developer.apple.com/assets/elements/badges/download-on-the-app-store.svg" alt="Download on App Store" style="height: 40px;">
                                </a>
                                <a href="https://play.google.com/store/apps/details?id=com.inkwellmobile" target="_blank" style="display: inline-block;">
                                    <img src="https://play.google.com/intl/en_us/badges/static/images/badges/en_badge_web_generic.png" alt="Get it on Google Play" style="height: 60px;">
                                </a>
                            </div>
                            <p style="margin: 1em 0 0 0; color: #888; font-size: 0.85em; font-style: italic;">
                                Apps are currently in beta testing and will be available in app stores soon.
                            </p>
                        </div>
                        
                        <div style="background: rgba(42,105,114,0.05); padding: 1.5em; border-radius: 8px; border-left: 4px solid #2A6972;">
                            <h3 style="color: #2A6972; margin-top: 0; font-size: 1.2em;">üìã How InkWell Works for Coaches</h3>
                            <ul style="margin: 0; padding-left: 1.5em; color: #444; line-height: 1.6;">
                                <li><strong>Client Selection:</strong> Your clients hand-select specific journal entries to share with you</li>
                                <li><strong>Email Notifications:</strong> Receive secure email links when a client shares an entry</li>
                                <li><strong>Review & Respond:</strong> Read entries with full context (mood, tags, audio) and provide support</li>
                                <li><strong>Secure:</strong> All communications are encrypted end-to-end</li>
                            </ul>
                        </div>
                        
                        <div style="text-align: center; margin-top: 1.5em; padding-top: 1.5em; border-top: 1px solid rgba(42,105,114,0.2);">
                            <p style="margin: 0.5em 0 0 0; color: #888; font-size: 0.95em; font-style: italic;">
                                Thank you for joining the InkWell community of certified coaches.
                            </p>
                        </div>
                    </div>
                `;
                
                // Hide form
                document.getElementById('registrationForm').style.display = 'none';
                
            } catch (error) {
                console.error('Registration error:', error);
                status.innerHTML = `<span style="color: #dc3545;">Error: ${error.message}</span>`;
                submitBtn.disabled = false;
                submitBtn.textContent = 'Complete Registration';
            }
        });
    </script>
</body>
</html>
